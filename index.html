<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>JavaScript Unit Testing</title>
    <link rel="stylesheet" href="styles/styles.css"/>
  </head>
  <body class="cube">
    <article>
      <section>
        <h1>JavaScript<br>Unit Testing</h1><img src="images/dilberttestscript.jpg" width="597">
      </section>
      <section>
        <h2>Why should we automate client side testing?</h2>
        <div class="imagebox"><img src="images/bigquestionmark.png" width="150" class="float-left">
          <ul class="left-align">
            <li>
              <li class="list-oomph">Business logic is moving from server to client</li>
              <li class="list-oomph">The same benefits of server side testing transfer to client</li>
            </li>
          </ul>
        </div>
      </section>
      <section>
        <h2>Verify Expectations</h2>
        <ul class="left-align fa-ul">
          <li></li>
          <li class="list-oomph success"><i class="fa-li fa fa-thumbs-up fa-lg"></i>Happy path</li>
          <li class="list-oomph error"><i class="fa-li fa fa-thumbs-down fa-lg"></i>Error conditions</li>
          <li class="list-oomph alert"><i class="fa-li fa fa-times icon-padding fa-lg"></i>Invalid input</li>
          <li class="list-oomph unexpected"><i class="fa-li fa fa-warning icon-padding fa-lg"></i>Unexpected input</li>
        </ul>
      </section>
      <section>
        <h2>Prevent regressions</h2><img src="images/gorilla-with-mac.png" width="500">
      </section>
      <section>
        <h2>a.k.a. Whack-a-mole!</h2><img src="images/whackamole.jpg">
        <ul class="left-align fa-ul">
          <li></li>
          <li class="list-oomph smell"><i class="fa-li fa fa-frown-o fa-lg"></i>Fix a bug, introduce another...</li>
        </ul>
      </section>
      <section>
        <h2>Document Specs</h2>
        <h3>The only documentation that is kept up to date</h3>
        <pre class="hack-height-2"><code class="language-javascript">describe('Password Validator', function() {
  it('Rejects short passwords', function() {
    var password = 'foo';
    var result = passwordValidator.isValid(password);
    expect(result).to.be(false);
  });
  it('Accepts password with mixed chars', function() {
    var password = 'abc123*&^%FEG'
    var result = passwordValidator.isValid(password);
    expect(result).to.be(true);
  });
});
</code></pre>
      </section>
      <section>
        <h2>Refactor with Confidence</h2><img src="images/confidence.png" width="370" height="400">
      </section>
      <section>
        <h2>Leads to cleaner code</h2>
        <div class="imagebox"><img src="images/clean-code-circle.png" width="200" height="200" class="img-padding"><img src="images/no-fish-circle.png" width="210" height="210" class="img-padding"></div>
        <ul class="left-align fa-ul">
          <li></li>
          <li class="list-oomph smell"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>If it's hard to test, that's a smell!</li>
        </ul>
      </section>
      <section>
        <h2>In the words of Uncle Bob...</h2>
        <p class="custom-quote"><i class="fa fa-quote-left fa-3x pull-left fa-border quote-border"></i>Why don't we clean up code that we know is messy? We're afraid we'll break it. But if we have the tests, we can be reasonably sure that the code is not broken, or that we'll detect the breakage immediately. If we have the tests we become fearless about making changes. If we see messy code, or an unclean structure, we can clean it without fear. Because of the tests, the code becomes malleable again. Because of the tests, software becomes soft again.</p>
        <div class="custom-cite"><a href="http://butunclebob.com/ArticleS.UncleBob.TheThreeRulesOfTdd">The Three Rules of TDD</a></div>
      </section>
      <section>
        <h2>JavaScript Unit Testing Challenges</h2>
        <ul class="left-align fa-ul">
          <li></li>
          <li class="list-oomph"><i class="fa-li fa fa-cubes fa-lg"></i>What are the units?</li>
          <li class="list-oomph"><i class="fa-li fa fa-random fa-lg"></i>Asynchronous execution</li>
          <li class="list-oomph"><i class="fa-li fa fa-file-code-o fa-lg"></i>DOM manipulation</li>
          <li class="list-oomph"><i class="fa-li fa fa-cog fa-spin fa-lg"></i>What tools are available?</li>
        </ul>
      </section>
      <section>
        <h2 class="big-heading">What are the units?</h2>
        <pre><code class="language-javascript">$('button').click(function() {
  var query = $('input').text();
  // Validation rule: only search if we have a query of at least two chars
  if (query && query.length >= 2) {
    $.ajax(url: 'http://content.guardianapis.com/search?show-fields=all&q=' + query, success: function(data) {
      var items = data.response.results;
      for (i = 0; i < items; i++) {
        // Business rule: only show news items that have pictures
        if (item.fields.thumbnail) {
          // sentiment is a global!
          sentimentResult = sentiment.analyze(item.fields.trailText);
          $('table').append('&lt;tr&gt;')
          $('table').append('&lt;td&gt;' + item.fields.byline + '&lt;/tr&gt;')  // author
          $('table').append('&lt;td&gt;' + item.fields.trailText + '&lt;/tr&gt;')  // content
          $('table').append('&lt;td&gt;' + item.fields.thumbnail + '&lt;/tr&gt;')  // thumbnail
          $('table').append('&lt;td&gt;' + item.fields.webUrl + '&lt;/tr&gt;')  // url
          $('table').append('&lt;td&gt;' + item.fields.webTitle + '&lt;/tr&gt;')  // title
          $('table').append('&lt;td&gt;' + item.fields.webPublicationDate + '&lt;/tr&gt;')  // publishDate
          $('table').append('&lt;td&gt;' + sentimentResult + '&lt;/tr&gt;')  // sentiment analysis
          $('table').append('&lt;/tr&gt;')
        }
      }
    }, error: function(jqXHR, textStatus, errorThrown) {
      $('.errorBox').text(textStatus + ', ' + errorThrown);
      $('.errorBox').show();
    });
  }
});
</code></pre>
      </section>
      <section>
        <h2>Use a module system</h2>
        <pre class="hack-height"><code class="language-javascript">// News Module
define(['jquery', 'sentiment'], function($, sentiment) {
  var init = function(config) { ... },
  var validate = function(query) { ... },
  var search = function(query) { ... },
  var process = function(items) { ... },
  var display = function(loadInto, items) { ... }
});</code></pre>
        <ul class="left-align fa-ul">
          <li></li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Break up logic into small functions</li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Declare dependencies in separate modules</li>
        </ul>
      </section>
      <section>
        <h2>Stack for BDD Style Testing</h2>
        <ul class="left-align">
          <li></li>
          <li><a href="http://visionmedia.github.io/mocha/">Mocha test framework</a> describe... it...</li>
          <li><a href="http://chaijs.com/api/bdd/">Chai Assertion Library</a> expect... to...</li>
          <li><a href="http://sinonjs.org/docs/">Sinon.JS</a> spies, stubs, and mocks</li>
          <li><a href="http://karma-runner.github.io/0.12/intro/how-it-works.html">Karma Runner</a> Multiple browsers, reporters</li>
          <li><a href="https://github.com/karma-runner/grunt-karma">Grunt</a> Run automation, local and CI</li>
          <li><a href="http://jasmine.github.io/1.3/introduction.html">Jasmine</a> is an alternative that can be used in place of Mocha, Chai and Sinon</li>
        </ul>
      </section>
      <section>
        <h2>DEMO News Application</h2>
        <ul>
          <li><a href="http://danielabar.github.io/learn-js-test/">http://danielabar.github.io/learn-js-test/</a></li>
          <li><a href="https://github.com/danielabar/learn-js-test/tree/master">https://github.com/danielabar/learn-js-test/tree/master</a></li>
        </ul>
      </section>
      <section>
        <h2><a href="https://github.com/danielabar/learn-js-test">Demo</a></h2>
        <h3>Simple function with inputs and output</h3>
        <ul class="left-align fa-ul">
          <li></li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>No dependencies</li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Synchronous</li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>No side effects</li>
        </ul>
      </section>
      <section>
        <h2><a href="https://github.com/danielabar/learn-js-test">Demo</a></h2>
        <h3>Using Sinon to mock out dependency</h3>
        <ul class="left-align fa-ul">
          <li></li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Test one thing only</li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Mock out everything else</li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Verify interactions</li>
        </ul>
      </section>
      <section>
        <h2><a href="https://github.com/danielabar/learn-js-test">Demo</a></h2>
        <h3>Asynchronous Execution</h3>
        <ul class="left-align fa-ul">
          <li></li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Use promises</li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Use sinon to mock and replace function - resolve or reject</li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Call Mocha's done() method to signify end of test</li>
        </ul>
      </section>
      <section>
        <h2><a href="https://github.com/danielabar/learn-js-test">Demo</a></h2>
        <h3>DOM Manipulation</h3>
        <ul class="left-align fa-ul">
          <li></li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Use Karma html2js plugin</li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Inject HTML snippet for code to operate on</li>
          <li class="list-oomph"><i class="fa-li fa fa-arrow-circle-right fa-lg"></i>Use jQuery to verify HTML snippet was modified</li>
        </ul>
      </section>
      <section>
        <h2>Karma Features</h2>
        <ul class="left-align">
          <li></li>
          <li>Capture multiple browsers<img src="images/Chrome.png" width="30" height="30"><img src="images/Firefox.png" width="30" height="30"><img src="images/Safari.png" width="30" height="30"><img src="images/Opera.png" width="30" height="30"><img src="images/IE.png" width="30" height="30"></li>
          <li>Test from other devices<i class="fa fa-mobile icon-padding"></i><i class="fa fa-tablet icon-padding"></i></li>
          <li><a href="http://karma-runner.github.io/0.8/config/coverage.html">Coverage reporter</a></li>
          <li><a href="https://www.npmjs.org/search?q=karma">Many other plugins available</a></li>
        </ul>
      </section>
      <section>
        <h2>Continuous Integration</h2>
        <ul>
          <li></li>
          <li class="list-oomph">Because developers are human</li>
          <li class="list-oomph">and sometimes forget...</li>
          <li class="list-oomph">to run the tests before pushing!<img src="images/mr-forgetful.png"></li>
        </ul>
      </section>
      <section>
        <h2>Continuous Integration</h2>
        <ul>
          <li><img src="images/ci.png" width="500" height="350"></li>
        </ul>
      </section>
      <section data-bespoke-state="emphatic"><img src="images/banner_qa.jpg" class="img-border"></section>
    </article>
    <script src="scripts/scripts.js"></script>
  </body>
</html>